SaltStack Introduction Demo
===========================

> This is a short documentation on the talk I held on September 25th 2014 at a
> [Geek2Geek meetup in
> Berlin](http://www.meetup.com/geek2geek/events/205940462/).


> The Slides are available
> [here](https://cdn.rawgit.com/flower-pot/blog/master/slides/2014-09-25-SaltStack/slides.html)

To be able to run the demo you need [vagrant](http://www.vagrantup.com/) and
[virtualbox](https://www.virtualbox.org/) installed.

Furthermore you need to install salt-master on your host machine.

	wget -O - https://bootstrap.saltstack.com | sudo sh

Then create a symlink to the demo salt root directory.

	sudo ln -s demo/saltstack/roots/ /srv

Now we can start the machines.

	vagrant up

> This might take a while as it also installs salt-minion in all machines

Once the machines are up they machines should look like this

	$ vagrant status
	Current machine states:
	
	minion1                   running (virtualbox)
	minion2                   running (virtualbox)
	minion3                   running (virtualbox)

By now they should have tried to authenticate with the salt-master on your host
machine. You can check by looking if they are unaccepted/pending keys.

	$ sudo salt-key -L
	Accepted Keys:
	Unaccepted Keys:
	minion1
	minion2
	minion3
	Rejected Keys:

Accept the keys

	sudo salt-key -a minion1
	sudo salt-key -a minion2
	sudo salt-key -a minion3

> Keys can also be generated by the master and distributed to the minions, that
> way they don't have to be accepted by the master

Once the keys are added they should now be in the `Accepted Keys` category when
running `sudo salt-key -L` from above.

Now salt commands can be executed, for example check if all minions are
ping-able

	salt '*' test.ping

Or call the highstate to run the states from the `saltstack/roots/salt`
directory.

	salt '*' state.highstate

> If requested I can do a blogpost explaining the salt states in more detail.
